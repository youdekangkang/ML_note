## 推荐系统常指标

[Toc]

混淆矩阵用于反映预测和真实的对应样本数，例如TP反映预测为真的样本也是正样本的样本数。

|          | 正样本 | 负样本 |
| -------- | ------ | ------ |
| 预测为真 | TP     | FP     |
| 预测为假 | FN     | TN     |

### NDCG

这个评价指标名为Normalized Discounted cumulative gain直接翻译为归一化折损累计增益。他有一些列的评价指标：CG,DCG,NDCG

#### CG

$$
CG = \sum_{i=1}^{p} rel_{i}
$$

cumulative gain（CG）可翻译为累积增益，只考虑相关性而没有考虑位置的影响。其计算方式也比较简单，对搜索相关性进行求和。

在推荐系统中，$ rel_{i} $表示第 $i$ 个位置的item是否是用户喜欢的，喜欢为1，否则为0。CG只能反映总体情况，即反映该页面中推荐的所有item的总分是好是坏。



#### DCG

$$
DCG = rel_{1} + \sum_{i=2}^{p} \frac{rel_{i}}{log_{2}i}
$$

discounted CG简称为DCG，这对CG的问题(没有考虑推荐的次序)，DCG的计算方式考虑了位置因素。例如，被推荐的item排在第1位和排在第10位，他们的影响力是不同的，肯定是第1位的影响力更大。因为用户进去第一眼就能看到第1位的item。计算公式如下，第1位不需要衰减，而随着位次不断靠后，其影响力也不断减弱。

其还有另外一种表达形式：

$$
DCG = \sum_{i=1}^{p} \frac{2^{rel_{i}} - 1}{log_{2}(i+1)}
$$

#### NDCG

顾名思义就是标准化后的DCG

由于DCG没有考虑到推荐列表和每个检索中真正有效结果的个数，所以最后我们引入NDCG （normalized discounted CG）
$$
NDCG_{k} = \frac{DCG_{k}}{IDCG_{k}}
$$
IDCG指理想化的DCG，也就是DCG的理论最大值，越接近1越准确



#### 一个栗子

假设我们给用户推荐五部电影,$M_{1},M_{2},M_{3},M_{4},M_{5}$,他们的评分为5,3,2,1,2

那么这个推荐列表的CG为：

$$
CG_{5} = 5 + 3 + 2 + 1 + 2 = 13
$$
那么DCG为：

$$
DCG_{5} = \frac{2^{5}-1}{log_{2}2} +\frac{2^{3}-1}{log_{2}3} + \frac{2^{2}-1}{log_{2}4} + \frac{2^{1}-1}{log_{2}5} + \frac{2^{2}-1}{log_{2}6} \\
= 31 + 4.4 + 1.5 + 0.4 + 1.2 = 38.5
$$
NDCG为：

$$
NDCG_{5} = \frac{DCG_{5}}{IDCG_{5}} = \frac{38.5}{46.5} = 0.827
$$
